<link rel="import" href="/bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="/bower_components/paper-card/paper-card.html">

<dom-module id="nb-build-number-app">
  <style>
    :host {
      display: block;
    }

    .item {
      margin: 5px;
    }
  </style>
  
  <template>
    <iron-ajax auto url="/version" handle-as="json" on-response="onVersionResponse"></iron-ajax>
    <template is="dom-repeat" items="{{apps}}">
      <paper-card class="item" heading="{{item.app}}">
        <div class="card-content">{{item.version}}</div>
        <div class="card-actions">
          <span>{{formatDate(item.date)}}</span>
        </div>
      </paper-card>
    </template>
  </template>

</dom-module>

<script>
  Polymer({
    is: 'nb-build-number-app',
    properties: {
      apps: {
        type: Array,
        value: function() {
          return [];
        }
      },
    },
    onVersionResponse: function(data) {
      this.apps = data.detail.response;
      console.log(this.apps);
    },
    formatDate: function(date) {
      return moment(date).fromNow();
    }
  });
</script>
